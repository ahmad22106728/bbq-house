<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø·Ø¹Ù…</title>

<style>
body {
    background:#111;
    color:#fff;
    font-family:'Cairo', sans-serif;
    direction:rtl;
    text-align:center;
    padding:40px 20px;
}

h1 {
    margin-bottom:10px;
}

p {
    color:#aaa;
    margin-bottom:30px;
}

.stars {
    display:flex;
    justify-content:center;
    flex-direction:row-reverse;
    gap:10px;
    margin-bottom:20px;
}

.stars input { display:none; }

.stars label {
    font-size:40px;
    color:#444;
    cursor:pointer;
    transition:0.2s;
}

.stars input:checked ~ label,
.stars label:hover,
.stars label:hover ~ label {
    color:#ff8800;
}

textarea {
    width:100%;
    max-width:400px;
    height:120px;
    background:#222;
    border:none;
    border-radius:10px;
    padding:12px;
    color:white;
    font-size:15px;
    margin-bottom:20px;
}

button {
    background:#ff8800;
    border:none;
    padding:12px 30px;
    border-radius:30px;
    font-weight:bold;
    cursor:pointer;
    transition:0.3s;
}

button:hover {
    opacity:0.8;
}

.review-card {
    background:#1b1b1b;
    padding:15px;
    border-radius:12px;
    margin:15px auto;
    max-width:400px;
    text-align:right;
    border:1px solid #333;
}

.review-stars {
    color:#ff8800;
    margin-bottom:8px;
}
</style>
</head>

<body>

<h1>â­ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø·Ø¹Ù…</h1>
<p>Ù†Ø´ÙƒØ±ÙƒÙ… Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙƒØ© Ø±Ø£ÙŠÙƒÙ…</p>

<form id="reviewForm">

<div class="stars">
    <input type="radio" name="rating" id="star5" value="5" required>
    <label for="star5">â˜…</label>

    <input type="radio" name="rating" id="star4" value="4">
    <label for="star4">â˜…</label>

    <input type="radio" name="rating" id="star3" value="3">
    <label for="star3">â˜…</label>

    <input type="radio" name="rating" id="star2" value="2">
    <label for="star2">â˜…</label>

    <input type="radio" name="rating" id="star1" value="1">
    <label for="star1">â˜…</label>
</div>

<textarea name="comment" placeholder="Ø§ÙƒØªØ¨ Ø±Ø£ÙŠÙƒ Ù‡Ù†Ø§..." required></textarea>

<br>
<button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>

</form>

<div id="reviewsContainer"></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
const supabaseUrl = "https://rlrgcngpezycnlorhpqg.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJscmdjbmdwZXp5Y25sb3JocHFnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExMTIwMzEsImV4cCI6MjA4NjY4ODAzMX0.KVWBqgLnRe7RVVrHEaiY6erdWNWhPCMc6tYmrYuH4I4"; // ğŸ”¥ Ø­Ø· Ù…ÙØªØ§Ø­Ùƒ Ù‡ÙˆÙ†

const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
async function loadReviews() {
    const { data, error } = await supabaseClient
        .from("reviews")
        .select("*")
        .order("created_at", { ascending: false });

    if (error) {
        console.error(error);
        return;
    }

    const container = document.getElementById("reviewsContainer");
    container.innerHTML = "";

    data.forEach(review => {
        container.innerHTML += `
            <div class="review-card">
                <div class="review-stars">${"â­".repeat(review.rating)}</div>
                <p>${review.comment}</p>
            </div>
        `;
    });
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
document.getElementById("reviewForm").addEventListener("submit", async function(e){
    e.preventDefault();

    const rating = document.querySelector('input[name="rating"]:checked')?.value;
    const comment = document.querySelector('textarea[name="comment"]').value;

    if (!rating || !comment) {
        alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ‚");
        return;
    }

    const { error } = await supabaseClient
        .from("reviews")
        .insert([{ rating: Number(rating), comment: comment }]);

    if (error) {
        console.error(error);
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
        return;
    }

    alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚ÙŠÙŠÙ…Ùƒ â¤ï¸");
    document.getElementById("reviewForm").reset();
    loadReviews();
});

loadReviews();
</script>

</body>
</html>
